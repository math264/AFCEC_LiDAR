<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8"/>

    <title>Exploration of Walkability in Lexington, KY</title>
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css"
      rel="stylesheet"
    />
     <!-- LOAD CSS External File -->
     <link rel="stylesheet" href="/CSS/styles.css" />
  </head>

  <body>
    <!-- Map Container -->
    <div id="map"></div>

    <!-- Header -->
    <div id="header">
      <header class="row">
        <div class="col">
          <h1>Exploration of Walkability in Lexington, KY</h1>
        </div>
      </header>
    </div>

    <!-- LEGEND CONTAINER -->
    <div id="ui">
      <h3 class="text-light">Lexington Routes</h3>
      <h4 class="text-light">(number of traffic signals)</h4>
      <ul id="legend-list"></ul>
    </div>

    <!-- LOADING -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js"></script>
    <script src="https://api.mapbox.com/mapbox.js/plugins/turf/v3.0.11/turf.min.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>

    <script>
      mapboxgl.accessToken =
        "pk.eyJ1IjoibWF0bWFwcGVyMjY0IiwiYSI6ImNsMzB6MHNzZzFvamIzZW5zaXZqbmxib3EifQ.Hm-ZK3tRYtO2pdV6nQhnKA";
      const map = new mapboxgl.Map({
        container: "map", // Specify the container ID
        style: "mapbox://styles/mapbox/dark-v10", // Specify which map style to use
        center: [38.04, -84.5], // Specify the starting position [lng, lat]
        zoom: 13.25, // Specify the starting zoom
      });

      // LOAD DATA
      // Load Markers
      map.on("load", () => {
        // request our GEOJSON data
        d3.json("Raw_Data/Markers.geojson").then((markers) => {
          addData(markers);
        });
      });

      // Load PNG
      map.on("load", () => {
        // Load an image from an external URL.
        map.loadImage("./Images/icon.png", (error, image) => {
          if (error) throw error;
          // Add the image to the map style.
          map.addImage("png", image);
        });
      });
      // END LOAD DATA

      // ADD DATA LAYERS
      // Add BRIDGES
      //   Add Layer to Map
      function addData(markers) {
        // first add the source to the map
        map.addSource("metric-data", {
          type: "geojson",
          data: markers, // use our data as the data source
        });

        // add the GeoJSON data as a mapbox gl layer
        map.addLayer({
          id: "markr",
          type: "symbol",
          source: "metric-data",
          layout: {
            "icon-image": "png", // reference the image
            "icon-size": 0.025,
          },
        });
      }
      // END DATA LAYERS
    </script>
  </body>
</html>
